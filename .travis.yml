language: node_js
node_js:
  - "lts/*"
cache: yarn

after_success: npx codecov

jobs:
  include:
    - script: yarn test:coverage

    - stage: release
      if: branch = master
      node_js: lts/*
      script: skip
      deploy:
        provider: script
        skip_cleanup: true
        script: "git remote add release https://${GH_TOKEN}@github.com/${TRAVIS_REPO_SLUG}.git && git checkout master && lerna publish --yes --git-remote release"
